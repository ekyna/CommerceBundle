define(["jquery","ekyna-form/collection"],function(a){"use strict";return a.fn.shipmentWidget=function(){return this.each(function(){var b=a(this),c=b.attr("name"),d=b.find(".shipment-items"),e=b.find('[name="'+c+'[state]"]'),f=b.find('[name="'+c+'[shippedAt]"]');console.log("shipmentWidget",d.length,e.length,f.length),e.on("change",function(){f.prop("disabled",!("shipped"===e.val()||"completed"===e.val()))}).trigger("change"),d.on("blur","input",function(){var b=a(this),c=parseInt(b.val());isNaN(c)&&b.val(0).trigger("change")}).on("change keyup","input",function(){var b=a(this),c=parseInt(b.val()),e=d.find('[data-parent="'+b.attr("id")+'"]');isNaN(c)&&(c=0),c>b.data("max")?b.closest("tr").addClass("has-error danger"):b.closest("tr").removeClass("has-error danger"),e.each(function(){var b=a(this);b.val(c*b.data("quantity")).trigger("change")})}).find("input").not(":disabled").trigger("change")}),this},{init:function(a){a.shipmentWidget()}}});