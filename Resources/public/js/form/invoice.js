define(["jquery","ekyna-form/collection"],function(a){"use strict";return a.fn.invoiceWidget=function(){return this.each(function(){var b=a(this).find(".invoice-items > tbody > tr input"),c=a(this).find("#toggle-quantities");console.log("invoiceWidget",b.length),b.on("blur",function(){var b=a(this),c=parseInt(b.val());isNaN(c)&&b.val(0).trigger("change")}).on("change keyup",function(){var c=a(this),d=parseInt(c.val()),e=b.find('[data-parent="'+c.attr("id")+'"]');isNaN(d)&&(d=0),d>c.data("max")?c.closest("tr").addClass("has-error danger"):c.closest("tr").removeClass("has-error danger"),e.each(function(){var b=a(this);b.val(d*b.data("quantity")).trigger("change")})}).not(":disabled").trigger("change"),c.on("click",function(){var c=0,d=0;b.each(function(b,e){var f=a(e);c+=parseFloat(f.val()),d+=f.data("max")}),c/d>.5?b.not(":disabled").each(function(b,c){a(c).val(0)}).trigger("change"):b.not(":disabled").each(function(b,c){var d=a(c);d.val(d.data("max"))}).trigger("change")})}),this},{init:function(a){a.invoiceWidget()}}});