define(["jquery","routing"],function(a,b){"use strict";return a.fn.saleAddressWidget=function(){return this.each(function(){var c=a(this),d=c.data("mode"),e=a("#"+c.data("customer-field")),f=c.find(".sale-address-same"),g=c.find(".sale-address-choice"),h=c.find(".sale-address"),i={company:".address-company",gender:".identity-gender",first_name:".identity-first-name",last_name:".identity-last-name",street:".address-street",complement:".address-complement",supplement:".address-supplement",postal_code:".address-postal-code",city:".address-city",country:".address-country",phone:".address-phone",mobile:".address-mobile"},j=function(){for(var a in i)i.hasOwnProperty(a)&&h.find(i[a]).val(null).trigger("change")},k=function(a){j();for(var b in i)i.hasOwnProperty(b)&&h.find(i[b]).val(a[b]).trigger("change")};if(1===e.size()&&e.on("change",function(){g.empty().append(a("<option value>Choose</option>")).prop("disabled",!0);var c=a(this).val();if(c){var e=a.get(b.generate("ekyna_commerce_customer_address_admin_choice_list",{customerId:c}));e.done(function(b){if("undefined"!=typeof b.choices){for(var c in b.choices)if(b.choices.hasOwnProperty(c)){var e=b.choices[c];g.append(a("<option />").attr("value",e.id).text(e.text).data("address",e)),"invoice"===d&&1===e.invoice_default?k(e):"delivery"===d&&1===e.delivery_default&&(1===e.invoice_default?(1===f.size()&&f.prop("checked",!0).trigger("change"),j()):(1===f.size()&&f.prop("checked",!1).trigger("change"),k(e)))}g.prop("disabled",!1)}g.trigger("form_choices_loaded",b)})}}),g.on("change",function(){var a=g.val();if(a){var b=g.find("option[value="+g.val()+"]");if(0!==b.size()){var c=b.data("address");c&&c.hasOwnProperty("id")&&k(c)}}}),1===f.size()){var l=c.find(".sale-address-wrap"),m=function(){f.prop("checked")?l.slideUp(function(){g.size()?g.val(null).trigger("change"):j()}):l.slideDown()};f.on("change",m),m()}}),this},{init:function(a){a.saleAddressWidget()}}});