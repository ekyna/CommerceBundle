define(["jquery","routing","tinymce"],function(d,f){"use strict";if("undefined"==typeof tinymce)throw"Tinymce is not available.";return d.fn.notifyModelChoiceWidget=function(){this.each(function(){var n,t=d(this),e=t.closest("form"),i=t.find(".model-choice"),a=t.find(".locale-choice"),o=e.find(".notify-subject"),s=e.find(".notify-message"),c=t.data("sale-type"),r=s.attr("id");return t.on("change","select",function(){var e=i.val();e?(i.parent().removeClass("has-warning"),(e={id:e,_locale:a.val()})[c+"Id"]=t.data("sale-id"),d.getJSON(f.generate("admin_ekyna_commerce_"+c+"_notify_model",e),function(e){e.hasOwnProperty("subject")&&o.val(e.subject),e.hasOwnProperty("message")&&((n=tinymce.get(r))?n.setContent(e.message):s.val(e.message))})):i.parent().addClass("has-warning")}),this})},{init:function(e){e.notifyModelChoiceWidget()}}});